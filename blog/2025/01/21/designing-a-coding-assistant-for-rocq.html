<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">ü§ñ Designing a coding assistant for Rocq | Formal Land</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://formal.land/img/land-512.png"><meta data-rh="true" name="twitter:image" content="https://formal.land/img/land-512.png"><meta data-rh="true" property="og:url" content="https://formal.land/blog/2025/01/21/designing-a-coding-assistant-for-rocq"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ü§ñ Designing a coding assistant for Rocq | Formal Land"><meta data-rh="true" name="description" content="This blog post provides a review of the existing literature on agent-based systems for automated theorem proving, while presenting a general approach to the problem. Additionally, it serves as an informal specification outlining the requirements for a future system we intend to develop."><meta data-rh="true" property="og:description" content="This blog post provides a review of the existing literature on agent-based systems for automated theorem proving, while presenting a general approach to the problem. Additionally, it serves as an informal specification outlining the requirements for a future system we intend to develop."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-01-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/andreadlm"><meta data-rh="true" property="article:tag" content="llm,ai"><link data-rh="true" rel="icon" href="/img/land-512.png"><link data-rh="true" rel="canonical" href="https://formal.land/blog/2025/01/21/designing-a-coding-assistant-for-rocq"><link data-rh="true" rel="alternate" href="https://formal.land/blog/2025/01/21/designing-a-coding-assistant-for-rocq" hreflang="en"><link data-rh="true" rel="alternate" href="https://formal.land/blog/2025/01/21/designing-a-coding-assistant-for-rocq" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Formal Land RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Formal Land Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/js/hotjar-analytics.js"></script>
<script data-domain="formal.land" defer="defer" src="https://plausible.io/js/script.js"></script><link rel="stylesheet" href="/assets/css/styles.54407260.css">
<script src="/assets/js/runtime~main.fdb5f117.js" defer="defer"></script>
<script src="/assets/js/main.75d5a72c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Building financial software? Get a formal verification quote <a href="https://calendly.com/guillaume-claret">here</a>.</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/land-512.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/land-512.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Formal Land</b></a><a class="navbar__item navbar__link" href="/docs/audit">Audit Reports</a><a class="navbar__item navbar__link" href="/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/docs/company/about">Company</a><a class="navbar__item navbar__link" href="/docs/learn/start">Learn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/formal-land" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://gitlab.com/formal-land" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2026/01/20/translation-and-verification">ü¶Ñ Formal verification is translation and verification</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2026/01/16/functional-correctness-static-call-revm">ü¶Ä Functional correctness of STATIC_CALL in Revm</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2026/01/14/formal-verification-keccak-plonky3">ü•∑ Formal verification of the Keccak precompile from Plonky3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/09/02/verification-completeness-open-vm-chip">ü•∑ Verification of the completeness of an OpenVM chip</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/08/26/pretty-printing-rust-constraints">ü•∑ Pretty-printing of Rust ZK constraints</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="This blog post provides a review of the existing literature on agent-based systems for automated theorem proving, while presenting a general approach to the problem. Additionally, it serves as an informal specification outlining the requirements for a future system we intend to develop."><header><h1 class="title_f1Hy" itemprop="headline">ü§ñ Designing a coding assistant for Rocq</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-01-21T00:00:00.000Z" itemprop="datePublished">January 21, 2025</time> ¬∑ <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/andreadlm" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/andreadlm.png" alt="Andrea Delmastro" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/andreadlm" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Andrea Delmastro</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>This blog post provides a review of the existing literature on agent-based systems for automated theorem proving, while presenting a general approach to the problem. Additionally, it serves as an informal specification outlining the requirements for a future system we intend to develop.</p>
<div class="theme-admonition theme-admonition-success admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Ask for the highest security!</div><div class="admonitionContent_BuS1"><p>To ensure your code is fully secure today, contact us at¬†<a href="mailto:contact@formal.land" target="_blank" rel="noopener noreferrer">¬†üíåcontact@formal.land</a>!¬†üöÄ</p><p>We exclusively focus on formal verification to offer you the highest degree of security for your application.</p><p>We cover <strong>Rust</strong>, <strong>Solidity</strong>, and <strong>zero-knowledge</strong> projects.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-our-goal">üéØ Our goal<a href="#-our-goal" class="hash-link" aria-label="Direct link to üéØ Our goal" title="Direct link to üéØ Our goal">‚Äã</a></h2>
<p>We aim to develop an integrated coding assistant for the proof assistant <a href="https://rocq-prover.org/" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/coq/rocq-prover.org/refs/heads/main/rocq-id/logos/SVG/icon-rocq-orange.svg" height="18px">¬†Rocq/Coq</a> within <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>. Despite recent advancements in artificial intelligence, the challenge of creating systems that effectively assist users in writing formal verification code remains unresolved. Our primary focus is on providing support for theorem proving, which we consider the most compelling aspect of the task; other functionalities, such as definition writing, may be explored in future work.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-automated-theorem-proving-as-a-search-in-a-state-space">üå≥ Automated theorem proving as a search in a state space<a href="#-automated-theorem-proving-as-a-search-in-a-state-space" class="hash-link" aria-label="Direct link to üå≥ Automated theorem proving as a search in a state space" title="Direct link to üå≥ Automated theorem proving as a search in a state space">‚Äã</a></h2>
<p>A coding assistant for a proof assistant can take advantage of a fundamental property that is not possessed by traditional programming languages: it is always possible to deterministically verify whether the code generated for a demonstration is correct (or simply, not incorrect). It only requires the code to be well-typed. More broadly, the assistant can track the progress of the solution.
A proof can be seen as a sequence of tactics, each of which modifies the current goal. Consequently, the proof construction process can be framed as a search through a state space. Using classical terminology for such problems, we can categorize the components of our system as follows:</p>
<ul>
<li><strong>state</strong>: enriched representation of the current goal</li>
<li><strong>starting state</strong>: initial goal associated with the theorem (its definition)</li>
<li><strong>arrival state</strong>: closed goal</li>
<li><strong>actions</strong>: tactics</li>
</ul>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Tree search simple" src="/assets/images/tree_search_simple-5e8ad122ea65ccba44a6566afd2c80c5.svg" width="553" height="350" class="img_ev3q"></p></figure></div>
<p>Certain states can be pruned if they do not meet some conditions, such as error states, those where with certainty no progress has been made (e.g., the <a href="https://github.com/trishullab/copra" target="_blank" rel="noopener noreferrer">copra</a> system proposes a simple symbolic approach to recognize some trivial cases) or if too many attempts have already been made at a certain node.</p>
<p>The set of tactics that can be applied in a given state is potentially infinite. To guide the search, one or more oracles are queried, which provide suggestions on applicable tactics. These oracles can be either LLM-based agents or traditional symbolic procedures (e.g., <a href="https://coqhammer.github.io/" target="_blank" rel="noopener noreferrer">CoqHammer</a>). Multiple oracles may coexist, offering alternative solutions. Two examples of LLM-based oracles are:</p>
<ul>
<li>oracle that produces a list of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> possible alternative tactics to be applied at a given goal;</li>
<li>oracle that produces a complete demonstration for a given goal.</li>
</ul>
<p>It is not obvious whether a procedure that proceeds in depth or one that proceeds in breadth is preferable. As is often the case with research problems, a &quot;hybrid&quot; approach might be preferable. In any case, one could imagine ordering the frontier on the basis of how promising a certain state is, thereby guiding the search process. The problem of determining whether one state is more promising than another through heuristics (a kind of &quot;distance&quot; from the successful state) is certainly interesting and would merit future study.</p>
<p>One can imagine two procedures, one in breadth and one in depth. From the union of the two, a hybrid solution could be devised.</p>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Depth search" src="/assets/images/depth_tree_search-170da44a3a6f6cd52bf1ec8a7ad9a997.svg" width="894" height="329" class="img_ev3q">
</p><figcaption>Depth search</figcaption><p></p></figure></div>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Breadth search" src="/assets/images/breadth_tree_search-d2afb8d55c7415d5b2d8e81bb5e86d6a.svg" width="932" height="457" class="img_ev3q">
</p><figcaption>Breadth search by beam search: in this specific case, a heuristic is employed to limit the number of expanded nodes</figcaption><p></p></figure></div>
<p>The system should be flexible enough and allow for the implementation of different versions of the search algorithm that could be refined as the work progresses.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="learning-from-errors">Learning from errors<a href="#learning-from-errors" class="hash-link" aria-label="Direct link to Learning from errors" title="Direct link to Learning from errors">‚Äã</a></h3>
<p>By leveraging the ability of an LLM to generate an infinite number of tactics and possibly update the prompt to refine the query, errors can be exploited to generate new tactics. For example, a node (state) might not be closed as soon as it is expanded, but it could be re-expanded in the future, enriched with the knowledge of past errors.</p>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Tree errors" src="/assets/images/tree_errors-f170535941e783f1b8035dcd3f2f22f6.svg" width="379" height="205" class="img_ev3q"></p></figure></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-integration-with-the-user">üë®üèª‚Äçüíª Integration with the user<a href="#-integration-with-the-user" class="hash-link" aria-label="Direct link to üë®üèª‚Äçüíª Integration with the user" title="Direct link to üë®üèª‚Äçüíª Integration with the user">‚Äã</a></h2>
<p>The system must integrate forms of communication and interaction with the user, which guide the user&#x27;s construction of the proof. In this context, the coding assistant is not envisioned as a fully automated proof tool, but rather as a coding companion that leverages the support of the human developer. For instance, such a companion system does not necessarily need to complete the proof, but could instead generate partial solutions, offering the user multiple incomplete options and allowing them to select the one they deem most appropriate as a starting point.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-the-technology-stack">üîß The technology stack<a href="#-the-technology-stack" class="hash-link" aria-label="Direct link to üîß The technology stack" title="Direct link to üîß The technology stack">‚Äã</a></h2>
<p>The system is designed to be distributed as a Visual Studio Code extension. This approach offers several advantages, including access to the editor&#x27;s extensive ecosystem of APIs, which facilitates seamless integration into standard development workflows and user interactions. Additionally, it simplifies the publishing and installation processes.</p>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Tech stack" src="/assets/images/tech_stack-d5d9848eaba1e69b8b41c093f174c807.svg" width="811" height="607" class="img_ev3q"></p></figure></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="large-language-models">Large language models<a href="#large-language-models" class="hash-link" aria-label="Direct link to Large language models" title="Direct link to Large language models">‚Äã</a></h3>
<p>Models and ad-hoc architectures for theorem proving have been proposed in the literature, including <a href="https://github.com/lean-dojo/ReProver" target="_blank" rel="noopener noreferrer">ReProver</a> (for <a href="https://lean-lang.org/" target="_blank" rel="noopener noreferrer">Lean</a>). The cost of maintaining and the complexity of configuring and adapting these systems is generally high. More simply, commercial versions of the most common LLMs (GPTs, , ...) can be used, leveraging prompt-engineering techniques. Several papers demonstrate that comparable results to state-of-the-art models can be achieved using such approaches.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-vscode-api-ecosystem">The VSCode API ecosystem<a href="#the-vscode-api-ecosystem" class="hash-link" aria-label="Direct link to The VSCode API ecosystem" title="Direct link to The VSCode API ecosystem">‚Äã</a></h3>
<p>VSCode offers a rich ecosystem of APIs that can be used to integrate your extension with common development processes, simplify user interaction, and communicate with external tools. In particular, the new <a href="https://code.visualstudio.com/api/extension-guides/language-model" target="_blank" rel="noopener noreferrer">Language Model API</a> is particularly useful for our purposes. It offers a common interface as well as tools to simplify communication with popular LLMs. Through the use of <a href="https://github.com/microsoft/vscode/blob/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts" target="_blank" rel="noopener noreferrer">Proposed API</a>, it is also possible to integrate local models, which are useful mainly in the testing phase of the first iterations. VSCode&#x27;s <a href="https://code.visualstudio.com/api/references/vscode-api#languages" target="_blank" rel="noopener noreferrer">Language API</a> simplifies the development and integration of an LSP client.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="language-server">Language server<a href="#language-server" class="hash-link" aria-label="Direct link to Language server" title="Direct link to Language server">‚Äã</a></h3>
<p>Language analysis capabilities are provided by the language server <a href="https://github.com/ejgallego/rocq-lsp" target="_blank" rel="noopener noreferrer">Coq-LSP</a>, which has recently been released as part of the <a href="https://github.com/ejgallego/rocq-lsp/tree/main/petanque" target="_blank" rel="noopener noreferrer">P√©tanque</a> project, a lightweight environment for intensive applications targeted at automated theorem-proving projects and especially at agent-based systems. P√©tanque operates as a <a href="https://gymnasium.farama.org/index.html" target="_blank" rel="noopener noreferrer">Gymnasium</a> environment and has already been successfully used in the <a href="https://github.com/LLM4Rocq/nlir" target="_blank" rel="noopener noreferrer">NLIR</a> system.
At the architectural level, Coq-LSP (and P√©tanque) operates as a server towards the coding assistant (the client), providing some functionality in the form of an API via an extended version of the <a href="https://microsoft.github.io/language-server-protocol/" target="_blank" rel="noopener noreferrer">LSP</a> protocol, including:</p>
<ul>
<li>obtaining the current goal for a given theorem,</li>
<li>obtaining the location of a given theorem&#x27;s definition,</li>
</ul>
<p>and many other functionalities commonly accessible through IDEs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-the-agent-perspective">üß† The agent perspective<a href="#-the-agent-perspective" class="hash-link" aria-label="Direct link to üß† The agent perspective" title="Direct link to üß† The agent perspective">‚Äã</a></h2>
<p>An alternative description of the system can be accomplished from the agent&#x27;s perspective. We understand an <em>agent</em> as a software system whose behavior is conditioned by an environment that it can actively alter by performing some actions whose effects condition subsequent observations and, consequently, its future choices.</p>
<div class="text--center"><figure><p><img decoding="async" loading="lazy" alt="Agent RL" src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDMzMi40NDc4MDY3NjA3NDc5IDE1Ny45MTY0NTY5NDAxMTcxIiB3aWR0aD0iMzMyLjQ0NzgwNjc2MDc0NzkiIGhlaWdodD0iMTU3LjkxNjQ1Njk0MDExNzEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IndoaXRlIi8+PCEtLSBzdmctc291cmNlOmV4Y2FsaWRyYXcgLS0+PG1ldGFkYXRhPjwvbWV0YWRhdGE+PGRlZnM+PHN0eWxlIGNsYXNzPSJzdHlsZS1mb250cyI+CiAgICAgIEBmb250LWZhY2UgeyBmb250LWZhbWlseTogRXhjYWxpZm9udDsgc3JjOiB1cmwoZGF0YTpmb250L3dvZmYyO2Jhc2U2NCxkMDlHTWdBQkFBQUFBQXZRQUE0QUFBQUFFK2dBQUF0OUFBRUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBR2hZYmd4Z2NOQVpnQUh3UkNBcWJHSlFQQ3lRQUFUWUNKQU5FQkNBRmd4Z0hJQnRLRDZPaWhMUml5UDZaa0ExWjZCc3VHRzJNa3JZaDJyaUx1czhaTFBncDN2S1NvU1ArdEo5OURORTZoUnlvTW85VVB0R1RWSjUvZjNmZS9aUnVYWWttRkYweEV5aEprSXZhNlg4QS8vN3p1ZGtITGZ6ZnpReVJGWXQrRTBOT0tpMnZ1bnM5NmU1Qk96UFlKbXNRV2JMN2plU0wyY0EweGZuUDM2djZYN2FPaVdNTFpvdEhhS3lUbTlIYUd2UkRIV09ETGJFNWFWRWJ5Zzl0ajVXZ0xFV3ZFUFFJYnlQdTBvU2ZXYmtBQXNCaDBJMUJTSUozcXdCWWZFVWpwamtoQXl5MjNyWUdzRGphS3V2QjRpcnRhQUlMQkFDNE41YWNlMXNUTUVEQWlJQUJzZDJZbDdRSjBGalVCZUtCa1Z2QmIyV0JvWkdMbnJJcC8wRWJrdVN1MjRFWVM5Z1A3K2NSSmd5T1FLSzlVUTR1d1p3V0FTaFloRWdpWTRGbWV4bll1WUFTd0tPQmFRQ1BZSDRCQWFLc0hMMG1Xbi8rM213NFNLMUx6QnRKUnMxdVlVbW1KZ2RBdkhVU3RQTDNHWVFpcjJvWFF4S1lRS1dyZFgwV1VwdFVYUU5ZbFltZWVraXgzZ3dEcmtIeUppUXFDVFhkTW9KSWFSUVZuV1RsS2xXcjFheERWNy9pU2RKU1ZhTzJuMnJFNUlURWtrVUw1alVGL0JCd1F6L0FrSkJtOXB4OEduRURjaVR2SmZZMllWaEFZa3lNWS90THFBYi9HYTF0QTJWbFJ3M29oWkh6eC9Kak93Ny9ldXB2QzlHTmlDNmhSb0ZLS0dRem9XUWhDVDk4Q1BCSFlJbXRUY1lMdnNuaDEyL2ZMamJtVUZ4UjdGNU94Zk11V0pobkFwSHRpQkFDQ1FaNE44T25BbWw2OFR6KzNiN1R3YXAwRkdWYTFNWDVEUFFad0VSckl3ekNPaTBZaHNPTEltMkpyWEVuUStkQXlmbkNCOFY1YzBkMmR1eUFkWDFXd0NHaWowR21ZbllYQUpidnlIS0g4MHFldHdid1hzNmJ3VVBwTlZOREJ1enFZT0VPdHp1MjB1RXkxNGdITUVqWURINzVFdUFFL1dGbGVtWndmcW5vRjBva0xiMUxOWE5GR0RGVnhsU21kN0RObFBqQmx4ZEZQcldhN1IxSzFuN2NGY0x3YnU0aHdDNTJJWm4wSHZWcVBTM002cFQ2MUc4b2MvekpQa2Q1SXRzYWlRaUFFU1FhU2VFS2hCaURjQ2ZOOFJGQ3ZzNllibGMrSEhveDNwaWJ6U2MrOXRkM04vUitlNmxuV1B0eEkrRFRqdU1vam15UHpySWMwK0pkYjJUN3pDQWQ4VzUwcTB6bjA4SHpjbHV5em1NTU1URUovS253MVZvcnNZWW9PN3BxekwwNDlJVHY2TnpyMVR3djV3SXJwS2lGNkJBa1g5ZWJzeDcwemtScHhTQTl3ZHlkR0l2OEdEZVVEbnlWVGk2dzQ2RmtuUzI3d2tKNmFuQ3Uwam5WeVFzUHQ4K3duVXpQakVnbUpMSnR1Zk9rR0p3dFczZTcxZHhmNy9WMmU3blFxc1N5RGNtelhzbFdPcmU1RXZEaVM4azZlVDhiVytMN0hzajJFUk9Za29Yb3lmYmRmaFVEakR2Ym9FaTIrWmNpM3lWSEd5QnFzaHhUWjIrczc4L2dYM0g3UFdxM2lzR0RFbkVJWFM0a0I4Z3MrQ21zTHlPYVpjZ3ZCanRJM214NkM5Q2NkUVVNMWRTU0F2VkZNWkR0SHN5N2t5L0c0OEtEVXJSQmlIbnhlbVZRdTZtNXpTYjBjamhFN1V4elduUlI5Q1hjcFljQTJBOHNZUmlFYlVSRlVhS0FxZmczQzlGVmxFM1JGcUxMa2hYKzVpem5sZytLQVZjYUJTbzJZbWpuUGNHY0ZaenIxeFVuanBWNGx4T3RrSHdxYUdaVDhBQU90ZGZEKzZ0akJtMG9ENHdIc3AwZVNUY3pGU2ZoYThQbWZKejZQbDFHbVdTQkVPQXV1SnZEYmxNZ0t6RDY5ZmErSjZmZTdPa0pKdWhLVmh0SlNiWGFCL2d4ZHo1UFBPeGlnTTJoeHdXOXBUUzNHRlNjQ0JJaW1KcmhCTXFyQTJRd2lON0lkc1VKVUR0RG1VNlhmZFRhZDRrYmRtUlBZTzJhVmVzbFRzSVFZQmZlUzJ1cFlLb3ZzNzNEMzRaMWVxdFZ6S2FETVIrRndFclFCaFZNNTVSOWQwNHBZcnlqbHljcExIWGVkSGJzR0l4MFFaZ3dZRzBIdTJpV3VZRkVGUWVnNUs4a0tEa2tuNThIL2U3SDB6alJMSXFXbjIvTXh2eWpyV0s2d0xqaVBNcW5XdDd6ZXBBb3poUG51aE1IU2pCK2U1MVRJdktHekl6TWRhYUxLb0R4L3pvc0s3OXQ3ZUQvZjgrc0dSNlJxQ2JPUC80ZjhvQzh4akhjb2Z5UFZsUnNFbXgyRUtlY0tjcCszN25tN1Vvdm5lYVRwQUNOUmMwdHV5WEhnSzdsTzloUUNHRmxGa3Q0bUdqT1Q1T2NFQnR0dWU4YmtDaU1KUmtaNHFWL2JLRGVVUzBLZGZ1Ri9SVyszbUI0ZjdMVFhQWE5iVmtCR2xqTmtZeG8yWHBxUmhTZHk5QXc2TnpNNG9EYnBGTHJ6RHdvTUF4TEgyM2VQKy9IblJNdFZqc0ZMMXkwK0Y4eUp1UzN0WDVPZTVvSnZYeTlScmIvV3lWZDNWTGw1b2tYV1duNXUxbTdUWnFmL3FrT3ZwdzJSRnpvbENkYk9xVTVIQjVqSk02V3Rpb3gyeFJLVU5GSmtVbDRCdi9zdytpK1RiTm44b2RML3NoZE43b3hGU0pRNGJ4aVFhTExSSThNYTJOWnoxaDNWQ2diUFM5WFprVnB0TjVLNU0xWTRHQWViMitzS2t6MFNyT055K0U1Ni80dHZkVWo5L3ZYVWp2c2taMDB1OWZDdDhXNUhtM2NrclU3MFZPNklpYlIyV2Q5ZGU5bzB4djRrYnFqTW5PZVVYY3hPVlBxanR4MVJ6d3I3T2NZK2NtMHNIWnA2TjhGK1RQbFNYTDdmTE1adkdUaUM1QWVaWnYxUHprR2JwR3BYRFN0R2VwQzRRVTBVR25FZStqQU9DSmdYczYrRnFMV0FpUjJoY0V0enB0WmdOSUhxUXhMNlhPdXRPNnFjQkhMNmlYSm4yVEZuNDZuakhaOGFHTmNhdXVkWWgvYU1tVlJRcUJmYnBiZ3Q3N2ZmOHNRR3Q0K1h1bnBtTXc4cGIrZStaY3dEd3E0Sm92VTErV0NLNThwZmRPc3NiSmlsNGZLMyt5cWhtT2NmalBocDkrRm5WN3dhTTRyMThCam1EcGkvUnYvTDRsb2J6M1pGa2liOVJTQ1M5YlBqbFYxMGFrSlpxL0xUYTJwTWM1RWFpNHVrd1kwWFArRHQ2a3NZWng0ekc5WE5HMU85cExiRTFOa3FjbUUyazNya1BlNG0yeC9wMkpaWStsM0EyYTJTaVYvK1ZldkFVbVhXQitTMTdoTWFaNVVLaGNkMDg3OVlJL0Q1YkhNeENJUmtZck5EUGFMbUJSdVpBWGwxSHhJQ2pFQXlmWmxrOTBIZFNuZlh0ZnI3YlVSRWJGYnE0NEtyemdxMUpKaVcwYlhDbnpUUkVjb2hpNVB0cTNsZFNzcWxsMzFmQWl6ZnJqOXlWckIyamkyVkN4TVNWdWduT3pmNTlDTHdvVFp3a2xtZjY4SHJyVWxuVUxuMEJiV2o1eC8rVS9hMkh6R2kySHZnekFmdHpyb2cvVWxqaXV4TitFeXpwejg0cURsWCs3a3VCMStKd2xwRjBlbDM3cTRhMzZjaVpHTHNrOVpMM1BtZFArWU1kTFVuK28xZ0pVei9kSzFQY0lWeVNzQ0VwN053NjdHWkxQYk1UL1ltUkJRUEEzMllTeHpVVlcxU0ZYZ3ZOTW90NmNZZHFxUW9EU3hkMUxyR3UxeDIxajJBbXN5RVdjS05DOFZQOVY1OEVLUVp1ODVoNnhtaDh0S3UzVjFzK3YzMmhneVJhbjREOGppc2FJR3JoTHV0U2RqdnhDMWRlNjFPMVd1aTJQaUpzZjhGcURmRWRNNGFQV3Vzc1ZYRWUrYUpZc04xYk5WcTZ1UmZZYTNwKzB2UjRVWmM3UU1GdzgyWWpXKzNGc1BzeHptOGJRU2NvODlSeDVnejBYclZzczNUTThmV3l3aG1SWXpqQkxPWnNQZ0ZKYllhU3EweWJqVHd5STIzQnFPNHVHeHVBelRna29uUHVjVTZ2L0VldjBlSmR2cXozbEJYVjRyRTlXWkZxb2dmZGxwUzZyeFFZRmpPb25aNGEvODltbTdqTkswQ1dUcXkvMmRYeTZjbmZEaHhiN01WemtoNnFMYnRMRFZibWdJSktIRCtVNm5EenF4KzUwbHhpek5qeGVaMW52S3J0elVoSWx6T0tiUTZzTTFzdlhlTG5oTGxaUGY1VDJxNFEzYllFenBCNzFnajd4UXp3OWxKZSt5K0Y0WjZQc21aWjlxdks2N2RzQkFkRXAybW9hdnBTcEwra01TVTFvVlEzQ2RGdjUwNUkvUVF2T1VYZDF5NnpGZ2oreGdKdVVkK09NYTgvcEprdzZ2ZkhQbnE3MVo5dW9WRnVmeno5NVBweGJ2VVJDbUJENTlNMVRWbzgzUUZVNFB1YWJhS0t5dzAvaXFLUG9mbGhOYitOcHE3Y3BpZnVRN0JodC9XQUlBYnZXNlR3QUF0OWMrNlI4Wi8zN2ljUmNHZ0FFckVmL0w3ZWhGQk1XK2J2elBXYjZ3bGRGbFBjQmUvaGxKRkNYbmVBaXFqeFF4WitsVjd1RXRRUmFKREEvQ2tzTzNsdk9MTGRlNFFlRUN0MGFMMEFXZ2dJbEFhQU5RQXA2V0I0OTJka3hQMitDMERaRTRhY1B3N0xiaDNFMjBFUnlWMlVqUkhFRUpwUVBvOUNoWHFrR3RLczJhZFBDUzl2ZU56Z1NVNnNnS2RMVnBKOGFFeVFwK3ZQbGlkd1FEbWUvVm9vYUpKTElBK0Z0d0Zabi84U0hjYXZlZ1dGL2I3YlhTR1NTSktMVmUySndJamRYZG9wZUEybHhVMHhKY2M4RE42dmJuKzBTZ2d6TGlma1ZaVk9RdWx1cm1MWFNyTk9CZVJYbHFENkRTWXBYb0VpWlY4SWFEY0NQZmtRQUEpOyB9PC9zdHlsZT48L2RlZnM+PGcgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMCA2NC42NjY4NjQxMzY4MjQ0Mikgcm90YXRlKDAgNjMuNTc2MzE0Mzk5NTQ1OTM2IDE1KSI+PHBhdGggZD0iTTcuNSAwIEMzNC4xNCAtMS4yMywgNjEuNTcgLTEuMzksIDExOS42NSAwIE03LjUgMCBDMzUuODQgLTAuMTEsIDYzLjYzIDEuODIsIDExOS42NSAwIE0xMTkuNjUgMCBDMTIyLjY3IDAuNTgsIDEyNi42OCAzLjQ3LCAxMjcuMTUgNy41IE0xMTkuNjUgMCBDMTIyLjc5IC0xLjgzLCAxMjYuMTQgMS4wNSwgMTI3LjE1IDcuNSBNMTI3LjE1IDcuNSBDMTI1Ljc2IDExLjY5LCAxMjcuMjMgMTcuNDksIDEyNy4xNSAyMi41IE0xMjcuMTUgNy41IEMxMjcuNzggMTIuMTIsIDEyNi45OCAxOC4yNywgMTI3LjE1IDIyLjUgTTEyNy4xNSAyMi41IEMxMjUuNDYgMjcuNDYsIDEyNS45NyAzMC4xNSwgMTE5LjY1IDMwIE0xMjcuMTUgMjIuNSBDMTI2LjU3IDI2LjA2LCAxMjIuNzUgMzEuMzksIDExOS42NSAzMCBNMTE5LjY1IDMwIEM5MS42IDI5LjUsIDY1LjI2IDI5LjE4LCA3LjUgMzAgTTExOS42NSAzMCBDODguNzUgMjkuNzgsIDU5LjA0IDMxLjA0LCA3LjUgMzAgTTcuNSAzMCBDMy42NyAzMS40MiwgLTAuMzggMjcuNSwgMCAyMi41IE03LjUgMzAgQzMuNzcgMzIuMDgsIDEuODQgMjkuMTcsIDAgMjIuNSBNMCAyMi41IEMwLjM0IDE4Ljg1LCAwLjY5IDE0LjUsIDAgNy41IE0wIDIyLjUgQy0wLjAzIDE4LjE3LCAwLjU4IDEzLjk4LCAwIDcuNSBNMCA3LjUgQy0wLjYzIDMuNTksIDEuNjEgLTEuNDQsIDcuNSAwIE0wIDcuNSBDMS45MyAxLjAxLCAzLjUzIDAuOTksIDcuNSAwIiBzdHJva2U9IiMxZTFlMWUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MC4yMjQzMjQ2NTM0NTIxODYgNjkuNjY2ODY0MTM2ODI0NDIpIHJvdGF0ZSgwIDIzLjM1MTk4OTc0NjA5Mzc1IDEwKSI+PHRleHQgeD0iMjMuMzUxOTg5NzQ2MDkzNzUiIHk9IjE0LjA5NiIgZm9udC1mYW1pbHk9IkV4Y2FsaWZvbnQsIFhpYW9sYWksIFNlZ29lIFVJIEVtb2ppIiBmb250LXNpemU9IjE2cHgiIGZpbGw9IiMxZTFlMWUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHN0eWxlPSJ3aGl0ZS1zcGFjZTogcHJlOyIgZGlyZWN0aW9uPSJsdHIiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIj5BZ2VudDwvdGV4dD48L2c+PGcgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTIuNTc4MjU4MDMxNzE4NjMgNjMuMjUxNTYzMjgzNjk0MTcpIHJvdGF0ZSgwIDY0LjkzNDc3NDM2NDUxNDYyIDE1KSI+PHBhdGggZD0iTTcuNSAwIEM0OC45NyAwLjIzLCA4Ni4wNCAxLjA2LCAxMjIuMzcgMCBNNy41IDAgQzMyLjAxIDAuOSwgNTUuMDIgMC4xMywgMTIyLjM3IDAgTTEyMi4zNyAwIEMxMjUuOTggMS4xLCAxMzEuNzMgMy4xMywgMTI5Ljg3IDcuNSBNMTIyLjM3IDAgQzEyNi41IC0wLjM2LCAxMjguMTIgMy4xNiwgMTI5Ljg3IDcuNSBNMTI5Ljg3IDcuNSBDMTI4LjU2IDE0LjA3LCAxMzAuNDggMTcuMzcsIDEyOS44NyAyMi41IE0xMjkuODcgNy41IEMxMjkuMjggMTEuNTgsIDEyOS4xNCAxNC41NiwgMTI5Ljg3IDIyLjUgTTEyOS44NyAyMi41IEMxMjkuMDcgMjYuOTksIDEyNy44MSAzMS41OSwgMTIyLjM3IDMwIE0xMjkuODcgMjIuNSBDMTI5LjUgMjUuNjcsIDEyNy4yMiAzMS44MSwgMTIyLjM3IDMwIE0xMjIuMzcgMzAgQzk4LjE1IDMyLjIxLCA3My4yNCAzMS40MSwgNy41IDMwIE0xMjIuMzcgMzAgQzkwLjA1IDMwLjA0LCA1Ny40NSAyOS44NiwgNy41IDMwIE03LjUgMzAgQzIuNDMgMjkuMzEsIC0wLjU2IDI2LjM1LCAwIDIyLjUgTTcuNSAzMCBDMi4wOSAyOC44MywgMC4xOCAyNS41MSwgMCAyMi41IE0wIDIyLjUgQy0wLjk2IDE3LjQzLCAtMC43MSAxMi4wNCwgMCA3LjUgTTAgMjIuNSBDLTAuNzEgMTkuMTQsIC0wLjU0IDE0LjA3LCAwIDcuNSBNMCA3LjUgQzAuNjggMC45NSwgMS40MiAtMC4wNSwgNy41IDAgTTAgNy41IEMxLjM3IDQuNTcsIDEuNjIgMS4yMiwgNy41IDAiIHN0cm9rZT0iIzFlMWUxZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMC44ODUwNTY5MzIzNjU4NCA2OC4yNTE1NjMyODM2OTQxNykgcm90YXRlKDAgNDYuNjI3OTc1NDYzODY3MTkgMTApIj48dGV4dCB4PSI0Ni42Mjc5NzU0NjM4NjcxOSIgeT0iMTQuMDk2IiBmb250LWZhbWlseT0iRXhjYWxpZm9udCwgWGlhb2xhaSwgU2Vnb2UgVUkgRW1vamkiIGZvbnQtc2l6ZT0iMTZweCIgZmlsbD0iIzFlMWUxZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgc3R5bGU9IndoaXRlLXNwYWNlOiBwcmU7IiBkaXJlY3Rpb249Imx0ciIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiPkVudmlyb25tZW50PC90ZXh0PjwvZz48ZyBzdHJva2UtbGluZWNhcD0icm91bmQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1NS42MTEwOTM5MjI5NTAyIDU3LjYwMjgxMjYyMDY3Njc5KSByb3RhdGUoMCAtOTIuOTE5MjUzNjEyMDk0NzQgLTExLjQxMTEzMzM1Mzc2NDYyNikiPjxwYXRoIGQ9Ik0wLjkyIDEuMTggQy0xNC41MiAtMi41MSwgLTYwLjc1IC0yMi44NSwgLTkxLjc1IC0yMy4xMSBDLTEyMi43NSAtMjMuMzgsIC0xNjkuNDggLTQuMjksIC0xODUuMDYgLTAuNCBNLTAuMDUgMC43NSBDLTE1LjcyIC0zLjIzLCAtNjEuNzYgLTI1LjA1LCAtOTIuNjUgLTI1LjEgQy0xMjMuNTUgLTI1LjE2LCAtMTcwLjA5IC0zLjk1LCAtMTg1LjQxIDAuNDIiIHN0cm9rZT0iIzFlMWUxZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1NS42MTEwOTM5MjI5NTAyIDU3LjYwMjgxMjYyMDY3Njc5KSByb3RhdGUoMCAtOTIuOTE5MjUzNjEyMDk0NzQgLTExLjQxMTEzMzM1Mzc2NDYyNikiPjxwYXRoIGQ9Ik0tMTY2LjE0IC0xNS41MSBDLTE3MS41MiAtOS4yNiwgLTE4MC4yOCAtMi4xMywgLTE4NS40MSAwLjQyIE0tMTY2LjE0IC0xNS41MSBDLTE3MS4wNyAtMTEuMTgsIC0xNzQuMzQgLTguMzEsIC0xODUuNDEgMC40MiIgc3Ryb2tlPSIjMWUxZTFlIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjU1LjYxMTA5MzkyMjk1MDIgNTcuNjAyODEyNjIwNjc2NzkpIHJvdGF0ZSgwIC05Mi45MTkyNTM2MTIwOTQ3NCAtMTEuNDExMTMzMzUzNzY0NjI2KSI+PHBhdGggZD0iTS0xNjAuNDEgMC42IEMtMTY3LjggMC44NywgLTE3OC43MSAxLjk2LCAtMTg1LjQxIDAuNDIgTS0xNjAuNDEgMC42IEMtMTY2LjY5IDEuMzUsIC0xNzEuMjMgMC42NSwgLTE4NS40MSAwLjQyIiBzdHJva2U9IiMxZTFlMWUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48L2c+PG1hc2s+PC9tYXNrPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgyLjI3MDUyNzgyMzM3NDMyIDEwKSByb3RhdGUoMCA3My42Mjg5NjI5MTQwNDYwNCA4LjI2MjE5NDc5ODU3NTU5MikiPjx0ZXh0IHg9IjczLjYyODk2MjkxNDA0NjA0IiB5PSIxMS42NDYzODk3ODgwNzIxNDUiIGZvbnQtZmFtaWx5PSJFeGNhbGlmb250LCBYaWFvbGFpLCBTZWdvZSBVSSBFbW9qaSIgZm9udC1zaXplPSIxMy4yMTk1MTE2Nzc3MjA5MzhweCIgZmlsbD0iIzFlMWUxZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgc3R5bGU9IndoaXRlLXNwYWNlOiBwcmU7IiBkaXJlY3Rpb249Imx0ciIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiPk9ic2VydmF0aW9uPC90ZXh0PjwvZz48ZyBzdHJva2UtbGluZWNhcD0icm91bmQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcyLjQ4OTUwNjYyODY5NzIgMTAxLjA3Mzc4MDI0MjYzMDM5KSByb3RhdGUoMCA5My4xOTA5ODA0MjkxMDQyMyAxMC44Njc3NTQzNDI2MzY2NTgpIj48cGF0aCBkPSJNLTAuMzEgMC44OSBDMTUuMzUgNC40OSwgNjIuMjggMjIuMDMsIDkzLjQ2IDIxLjk2IEMxMjQuNjMgMjEuODksIDE3MS4xIDQuMDYsIDE4Ni43NiAwLjQ4IE0xLjczIDAuMyBDMTcuNzggMy40OSwgNjQuODUgMTkuNzEsIDk1LjU5IDE5Ljk1IEMxMjYuMzQgMjAuMiwgMTcwLjc2IDQuODMsIDE4Ni4xOSAxLjc3IiBzdHJva2U9IiMxZTFlMWUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3Mi40ODk1MDY2Mjg2OTcyIDEwMS4wNzM3ODAyNDI2MzAzOSkgcm90YXRlKDAgOTMuMTkwOTgwNDI5MTA0MjMgMTAuODY3NzU0MzQyNjM2NjU4KSI+PHBhdGggZD0iTTE2NS41OSAxNS45MyBDMTcyLjM4IDEwLjQ4LCAxNzYuNjQgOS4yNSwgMTg2LjE5IDEuNzcgTTE2NS41OSAxNS45MyBDMTcxLjk0IDEyLjYsIDE3Ni45MyA4LjQxLCAxODYuMTkgMS43NyIgc3Ryb2tlPSIjMWUxZTFlIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzIuNDg5NTA2NjI4Njk3MiAxMDEuMDczNzgwMjQyNjMwMzkpIHJvdGF0ZSgwIDkzLjE5MDk4MDQyOTEwNDIzIDEwLjg2Nzc1NDM0MjYzNjY1OCkiPjxwYXRoIGQ9Ik0xNjEuMzEgLTAuNjIgQzE2OS4yNiAtMS43NiwgMTc0LjYzIDEuMzIsIDE4Ni4xOSAxLjc3IE0xNjEuMzEgLTAuNjIgQzE2OS4wNyAwLjkzLCAxNzUuMzIgMS42MywgMTg2LjE5IDEuNzciIHN0cm9rZT0iIzFlMWUxZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjwvZz48bWFzaz48L21hc2s+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTguODQzODIzOTY4NTk2NTUgMTMxLjM5MjA2NzM0Mjk2NTkpIHJvdGF0ZSgwIDczLjYyODk2MjkxNDA0NjA0IDguMjYyMTk0Nzk4NTc1NTkyKSI+PHRleHQgeD0iNzMuNjI4OTYyOTE0MDQ2MDQiIHk9IjExLjY0NjM4OTc4ODA3MjE0NSIgZm9udC1mYW1pbHk9IkV4Y2FsaWZvbnQsIFhpYW9sYWksIFNlZ29lIFVJIEVtb2ppIiBmb250LXNpemU9IjEzLjIxOTUxMTY3NzcyMDkzOHB4IiBmaWxsPSIjMWUxZTFlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBzdHlsZT0id2hpdGUtc3BhY2U6IHByZTsiIGRpcmVjdGlvbj0ibHRyIiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyI+QWN0aW9uPC90ZXh0PjwvZz48L3N2Zz4=" width="332" height="158" class="img_ev3q"></p></figure></div>
<p>Based on the above definition, we can attempt to classify the components of our system within a classic agent context as follows:</p>
<ul>
<li><strong>Agent</strong>: prompting + large language model + parsing</li>
<li><strong>Environment</strong>: user, language server and search algorithm</li>
<li><strong>Actions</strong>: tactics</li>
<li><strong>Observations</strong>: current goal, examples, definitions, ...</li>
</ul>
<figure><p><img decoding="async" loading="lazy" alt="Agent loop" src="/assets/images/agent_loop-0a837a1284810e14d15c2b0c7f468ab4.svg" width="1649" height="1373" class="img_ev3q"></p></figure>
<p>Let us recall that in the proposed general architecture, the agent is only one of the possible types of <em>oracle</em> from which we can obtain useful information to advance the demonstration (albeit the most interesting one), and that multiple <em>oracles</em> at the same time can coexist, e.g., agents implementing different resolution strategies or configurations.</p>
<p>The agent is designed to interact with various components of the environment, for example, by requesting examples, additional information, or simple advice from the user; the current goal; the list of previously attempted and failed tactics for the search algorithm; or semantic data from the language server. The interaction process could be deliberative (guided by the LLM&#x27;s reasoning) or, more simply, a form of abstraction for a predetermined set of information we intend to request. This interaction with the environment is crucial for defining the goal, enriching the agent&#x27;s context, and generating input for the prompt. In a recent <a href="/blog/2025/01/06/annotating-what-we-are-doing">blog post</a>, we documented our interest in internally gathering as much information as possible about the recurring human processes of building a demonstration in order to standardize and emulate them within the agent&#x27;s interaction logic with the environment.</p>
<p>Several propting techniques can be tried. In the <a href="https://github.com/LLM4Coq/nlir" target="_blank" rel="noopener noreferrer">NLIR</a> system, the prompt is gradually refined through a chain-of-thought approach: first, a natural language response is requested from the LLM, and this response is then used to generate a more precise Rocq code response.</p>
<p>Once the LLM produces an output‚Äîwhether a tactic, a list of tactics, or a complete proof, depending on the type of agent‚Äîthe response is parsed and executed within the environment via P√©tanque. If an error occurs, the environment is either reverted to its previous state (backtracking), or an error recovery technique is applied (e.g., replacing the problematic code with <code>admit.</code>).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-evaluation-strategies">üìä Evaluation strategies<a href="#-evaluation-strategies" class="hash-link" aria-label="Direct link to üìä Evaluation strategies" title="Direct link to üìä Evaluation strategies">‚Äã</a></h2>
<p>Benchmarks used for evaluating automated demonstration systems tend to be limited to classical mathematics, focusing on demonstration systems that are <em>completely automated</em> and not of <em>support</em> to demonstration writing.
As a result, these benchmarks can be misleading with regard to the practical utility of such tools in real-world contexts. In addition to traditional evaluation methods, the system should be tested in practical scenarios, such as by applying it to ongoing formal verification projects within <a href="/">Formal Land</a>.</p>
<p>A second critical consideration when evaluating a practical support tool is the cost per request. Integrated LLMs should not be viewed as infinite resources, but rather as constrained resources whose usage must be optimized and minimized, even if that means sacrificing some efficiency.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="Ô∏è-similar-projects-and-resources">üóÇÔ∏è Similar projects and resources<a href="#Ô∏è-similar-projects-and-resources" class="hash-link" aria-label="Direct link to üóÇÔ∏è Similar projects and resources" title="Direct link to üóÇÔ∏è Similar projects and resources">‚Äã</a></h2>
<p>The research field in fully autonomous automated theorem using proof assistants is very active and has received a strong boost since the advent of LLMs. The proposed system architecture has been influenced by the following works:</p>
<ul>
<li>LeanCopilot (<a href="https://github.com/lean-dojo/LeanCopilot" target="_blank" rel="noopener noreferrer">code</a>, <a href="https://arxiv.org/abs/2404.12534" target="_blank" rel="noopener noreferrer">paper</a>)</li>
<li>copra (<a href="https://github.com/trishullab/copra" target="_blank" rel="noopener noreferrer">code</a>, <a href="https://arxiv.org/abs/2310.04353" target="_blank" rel="noopener noreferrer">paper</a>)</li>
<li>CoqPilot (<a href="https://github.com/JetBrains-Research/coqpilot" target="_blank" rel="noopener noreferrer">code</a>, <a href="https://arxiv.org/abs/2410.19605" target="_blank" rel="noopener noreferrer">paper</a>)</li>
<li>NLIR (<a href="https://github.com/LLM4Coq/nlir" target="_blank" rel="noopener noreferrer">code</a>, <a href="https://openreview.net/forum?id=QzOc0tpdef" target="_blank" rel="noopener noreferrer">paper</a>)</li>
</ul>
<p>Other interesting resources to further explore this topic:</p>
<ul>
<li>üìΩÔ∏è <a href="https://www.youtube.com/watch?v=Yr8dzfVkeHg" target="_blank" rel="noopener noreferrer">Lean Together 2025: Jason Rute, The last mile</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-key-takeaway">ü•° Key takeaway<a href="#-key-takeaway" class="hash-link" aria-label="Direct link to ü•° Key takeaway" title="Direct link to ü•° Key takeaway">‚Äã</a></h2>
<ul>
<li>The agent perspective and the search perspective are here complemented in a single system</li>
<li>The automatic demonstration process can be seen as a sophisticated search in a space of states</li>
<li>The system must be flexible overall and adapt to different refinements that might be decided in the process</li>
<li>In a support tool, completeness of proof is not mandatory</li>
<li>User interaction is crucial</li>
<li>Evaluation must be carried out in a practical context</li>
</ul>
<div class="theme-admonition theme-admonition-success admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>For more</div><div class="admonitionContent_BuS1"><p><em>Follow us on <a href="https://x.com/FormalLand" target="_blank" rel="noopener noreferrer">X</a> or <a href="https://fr.linkedin.com/company/formal-land" target="_blank" rel="noopener noreferrer">LinkedIn</a> for more, or comment on this post below! Feel free to DM us for any questions or requests!</em></p></div></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/llm">llm</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ai">ai</a></li></ul></div></footer></article><div style="margin-top:40px"></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2025/01/30/links-for-rust-in-rocq"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">ü¶Ä Typing and naming of Rust code in Rocq (1/3)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2025/01/13/verification-one-instruction-sui"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">ü¶Ä Verification of one instruction of the Move&#x27;s type-checker</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-our-goal" class="table-of-contents__link toc-highlight">üéØ Our goal</a></li><li><a href="#-automated-theorem-proving-as-a-search-in-a-state-space" class="table-of-contents__link toc-highlight">üå≥ Automated theorem proving as a search in a state space</a><ul><li><a href="#learning-from-errors" class="table-of-contents__link toc-highlight">Learning from errors</a></li></ul></li><li><a href="#-integration-with-the-user" class="table-of-contents__link toc-highlight">üë®üèª‚Äçüíª Integration with the user</a></li><li><a href="#-the-technology-stack" class="table-of-contents__link toc-highlight">üîß The technology stack</a><ul><li><a href="#large-language-models" class="table-of-contents__link toc-highlight">Large language models</a></li><li><a href="#the-vscode-api-ecosystem" class="table-of-contents__link toc-highlight">The VSCode API ecosystem</a></li><li><a href="#language-server" class="table-of-contents__link toc-highlight">Language server</a></li></ul></li><li><a href="#-the-agent-perspective" class="table-of-contents__link toc-highlight">üß† The agent perspective</a></li><li><a href="#-evaluation-strategies" class="table-of-contents__link toc-highlight">üìä Evaluation strategies</a></li><li><a href="#Ô∏è-similar-projects-and-resources" class="table-of-contents__link toc-highlight">üóÇÔ∏è Similar projects and resources</a></li><li><a href="#-key-takeaway" class="table-of-contents__link toc-highlight">ü•° Key takeaway</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Content</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/audit">Audit Reports</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools">Tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/company/about">Company</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/learn/start">Learn</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://x.com/FormalLand" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fr.linkedin.com/company/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/formal_land" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.instagram.com/formal.land" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://bsky.app/profile/formalland.bsky.social" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bluesky<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://formal.land/blog/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:contact@formal.land" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitlab.com/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://formal-land.gitlab.io/coq-tezos-of-ocaml/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Coq Tezos of OCaml<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2026 Formal Land (Arae SARL), Paris, France<br><em>The highest standard of code security for Web3.</em><!-- Start of LiveChat (www.livechat.com) code -->
<script>window.__lc=window.__lc||{},window.__lc.license=14938650,function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.livechatinc.com/tracking.js",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice)</script>
<noscript><a href="https://www.livechat.com/chat-with/14938650/" rel="nofollow">Chat with us</a>, powered by <a href="https://www.livechat.com/?welcome" rel="noopener nofollow" target="_blank">LiveChat</a></noscript>
<!-- End of LiveChat code --></div></div></div></footer></div>
</body>
</html>